# multiquotes.test is part of the GNU m4 testsuite

#. ${srcdir}/defs

cat ${srcdir}/multiquotes.m4 >in

cat <<\EOF >ok

``traceon''
foo
``FOO''

BAR
foo bar
``FOO'' BAR
*>*>*<*<
EOF

cat <<\EOF >okerr
m4trace: -1- changequote(`[', `]')
m4trace: -1- dnl
m4trace: -1- changequote([``], [''])
m4trace: -1- dnl
m4trace: -1- define(``foo'', ````FOO'''')
m4trace: -1- dnl
foo:	````FOO''''
m4trace: -1- dumpdef(``foo'')
m4trace: -1- dnl
m4trace: -1- changequote(``!'', ``!'')
m4trace: -1- dnl
foo:	!``FOO''!
m4trace: -1- dumpdef(!foo!)
m4trace: -1- dnl
m4trace: -1- define(!bar!, !BAR!)
m4trace: -1- changequote(!>*>*>*>*>!, !<*<*<*<*<!)
m4trace: -1- dnl
bar:	>*>*>*>*>BAR<*<*<*<*<
foo:	>*>*>*>*>``FOO''<*<*<*<*<
m4trace: -1- dumpdef(>*>*>*>*>foo<*<*<*<*<, >*>*>*>*>bar<*<*<*<*<)
m4trace: -1- dnl
EOF

M4PATH=$srcdir:$srcdir/../tests $M4 -d in >out 2>err
sed -e "s, $M4:, m4:," err >sederr && mv sederr err
$CMP -s out ok && $CMP -s err okerr
