#!/bin/sh

# generated-tests/m4exit.1.test is part of the GNU m4 testsuite
# generated from example in m4.texinfo line 3582

#. ${srcdir}/defs

cat <<\EOF >in
define(`fatal_error', `errprint(`m4: '__file__: __line__`: fatal error: $*
')m4exit(1)')
fatal_error(`This is a BAD one, buster')
EOF

cat <<\EOF >ok

EOF

cat <<\EOF >okerr
m4: in: 3: fatal error: This is a BAD one, buster
EOF

$M4 -d in >out 2>err
sed -e "s,m4: ,m4: ," err >sederr && mv sederr err

$CMP -s out ok && $CMP -s err okerr

